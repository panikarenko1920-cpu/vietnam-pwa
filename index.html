<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vietnam Trip - Notion PWA</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffffff">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Vietnam Trip">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{background:#f9f9f9;color:#1a1a1a;overflow-x:hidden;}
header{padding:20px;text-align:center;background:#fff;border-bottom:1px solid #e0e0e0;box-shadow:0 1px 3px rgba(0,0,0,0.06);position:relative;z-index:5;}
header h1{font-weight:600;font-size:24px;margin-bottom:4px;}
header p{color:#555;font-size:14px;}
.burger{position:absolute;left:20px;top:25px;width:28px;height:22px;cursor:pointer;display:flex;flex-direction:column;justify-content:space-between;z-index:10;}
.burger div{height:4px;background:#333;border-radius:2px;}
.sidebar{position:fixed;top:0;left:-260px;width:250px;height:100%;background:#fff;box-shadow:2px 0 6px rgba(0,0,0,0.1);padding:20px;transition:left 0.3s ease;overflow-y:auto;z-index:100;}
.sidebar.open{left:0;}
.sidebar h3{margin-top:20px;margin-bottom:10px;font-size:16px;color:#111;}
.sidebar button{width:100%;padding:8px 10px;margin:4px 0;border:none;border-radius:8px;background:#f3f3f3;text-align:left;cursor:pointer;transition:all 0.2s ease;}
.sidebar button:hover{background:#e0e0e0;}
.container{max-width:520px;margin:16px auto;padding:0 16px;}
.card{display:none;background:#fff;border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 1px 4px rgba(0,0,0,0.08);}
.card.active{display:block;}
.section{margin-bottom:20px;}
.section h3{font-size:16px;font-weight:600;margin-bottom:8px;color:#111;}
.section h4{font-size:14px;font-weight:600;margin-bottom:4px;color:#333;}
.section ul{list-style:none;padding-left:0;}
.section ul li{padding:6px 0;position:relative;padding-left:22px;line-height:1.5;font-size:14px;}
.section ul li::before{content:"‚Ä¢";position:absolute;left:0;color:#888;font-size:14px;top:2px;}
.gallery{display:flex;overflow-x:auto;gap:10px;padding:6px 0;margin-top:8px;}
.gallery img{width:140px;height:100px;object-fit:cover;border-radius:12px;flex-shrink:0;box-shadow:0 1px 3px rgba(0,0,0,0.06);transition:transform 0.2s ease;}
.gallery img:hover{transform:scale(1.05);}
.day-nav{display:flex;justify-content:space-between;margin-top:12px;}
.day-nav button{padding:6px 12px;border:none;border-radius:8px;background:#f3f3f3;cursor:pointer;}
.edit-btn{margin-top:8px;padding:6px 12px;border:none;border-radius:8px;background:#f0f0f0;cursor:pointer;}
.edit-form label{display:block;margin:4px 0;font-size:13px;}
.edit-form input, .edit-form select{width:100%;padding:4px 6px;margin-top:2px;border:1px solid #ccc;border-radius:6px;font-size:13px;}
.edit-form button{margin-top:6px;padding:6px 10px;border:none;border-radius:8px;background:#cce5ff;cursor:pointer;}
</style>
</head>
<body>

<header>
<div class="burger" id="burger">
  <div></div>
  <div></div>
  <div></div>
</div>
<h1>üáªüá≥ Vietnam Trip</h1>
<p>–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ï–¥–∞ ‚Äî –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥–æ—Ä–æ–¥–∞–º</p>
</header>

<div class="sidebar" id="sidebar">
  <h3>–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üèõ</h3>
  <div id="attr-buttons"></div>
  <h3>–ï–¥–∞ üçú</h3>
  <div id="food-buttons"></div>
</div>

<div class="container" id="main-container"></div>

<script>
document.addEventListener('DOMContentLoaded', ()=>{

// ====== –î–ê–ù–ù–´–ï ======
const tripData = [
{city:"–•–æ–π–∞–Ω",days:[{day:1,title:"–°—Ç–∞—Ä—ã–π –≥–æ—Ä–æ–¥ üåÜ",folder:"images/hoian/day1",attractions:["–ü—Ä–æ–≥—É–ª–∫–∞ –ø–æ –°—Ç–∞—Ä–æ–º—É –≥–æ—Ä–æ–¥—É","–Ø–ø–æ–Ω—Å–∫–∏–π –º–æ—Å—Ç"],food:["–£–∂–∏–Ω –≤ Riverside Caf√©","–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å Cao Lau"]},{day:2,title:"–ü–ª—è–∂ –ê–Ω –ë–∞–Ω–≥ üèñ",folder:"images/hoian/day2",attractions:["–°–æ–ª–Ω—Ü–µ –∏ –º–æ—Ä–µ –Ω–∞ –ø–ª—è–∂–µ –ê–Ω –ë–∞–Ω–≥","–ü—Ä–æ–≥—É–ª–∫–∞ –≤–¥–æ–ª—å —Ä–µ–∫–∏"],food:["–ö–æ—Ñ–µ —É —Ä–µ–∫–∏","–£–ª–∏—á–Ω–∞—è –µ–¥–∞ –Ω–∞ –≤–µ—á–µ—Ä–Ω–µ–º —Ä—ã–Ω–∫–µ"]}]},
{city:"–î–∞–Ω–∞–Ω–≥",days:[{day:7,title:"My Khe Beach üèñ",folder:"images/danang/day7",attractions:["–û—Ç–¥—ã—Ö –Ω–∞ –ø–ª—è–∂–µ My Khe","–°—ë—Ä—Ñ–∏–Ω–≥ / SUP"],food:["–ó–∞–∫—É—Å–∫–∏ –Ω–∞ –ø–ª—è–∂–µ","–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã"]},{day:8,title:"Ba Na Hills ‚õ∞",folder:"images/danang/day8",attractions:["–ó–æ–ª–æ—Ç–æ–π –º–æ—Å—Ç","–ö–∞–Ω–∞—Ç–Ω–∞—è –¥–æ—Ä–æ–≥–∞ –∏ –ø–∞—Ä–∫–∏"],food:["–û–±–µ–¥ –≤ –≥–æ—Ä–∞—Ö","–ó–∞–∫—É—Å–∫–∏ –≤ –∫–∞—Ñ–µ"]}]},
{city:"–•–∞–Ω–æ–π",days:[{day:14,title:"–ò—Å—Ç–æ—Ä–∏—è üèõ",folder:"images/hanoi/day14",attractions:["–•—Ä–∞–º –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã","–ú–∞–≤–∑–æ–ª–µ–π –•–æ –®–∏ –ú–∏–Ω–∞"],food:["Ph·ªü","Egg coffee"]},{day:15,title:"–ì–∞—Å—Ç—Ä–æ üç≤",folder:"images/hanoi/day15",attractions:["–ü—Ä–æ–≥—É–ª–∫–∞ –ø–æ –°—Ç–∞—Ä–æ–º—É –∫–≤–∞—Ä—Ç–∞–ª—É","–†—ã–Ω–∫–∏"],food:["B√∫n ch·∫£","–£–ª–∏—á–Ω–∞—è –µ–¥–∞"]}]}
];

// ====== –ì–ê–õ–ï–†–ï–Ø ======
function createGallery(folder){
  const gallery=document.createElement('div'); gallery.className='gallery';
  for(let i=1;i<=10;i++){ const img=document.createElement('img'); img.src=`${folder}/${i}.jpg`; img.onerror=()=>img.remove(); gallery.appendChild(img);}
  return gallery;
}

// ====== –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï ======
function addEditForm(section, cityId, dayIndex){
  const formWrapper = document.createElement('div'); formWrapper.className='edit-form';
  formWrapper.innerHTML=`
    <button class="edit-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å / –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</button>
    <div class="edit-inner" style="display:none;margin-top:6px;">
      <label>–¢–∏–ø:
        <select class="item-type">
          <option value="attraction">–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å üèõ</option>
          <option value="food">–ï–¥–∞ üçú</option>
        </select>
      </label>
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ:<input type="text" class="item-name"></label>
      <label>–û–ø–∏—Å–∞–Ω–∏–µ:<input type="text" class="item-desc"></label>
      <label>–ö–∞—Ä—Ç–∏–Ω–∫–∞ URL:<input type="text" class="item-img"></label>
      <button class="add-item-btn">–î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</button>
    </div>
  `;
  section.appendChild(formWrapper);

  const editBtn = formWrapper.querySelector('.edit-btn');
  const editInner = formWrapper.querySelector('.edit-inner');
  editBtn.onclick = ()=>{ editInner.style.display = editInner.style.display==='none'?'block':'none'; }

  const addBtn = formWrapper.querySelector('.add-item-btn');
  addBtn.onclick = ()=>{
    const type = formWrapper.querySelector('.item-type').value;
    const name = formWrapper.querySelector('.item-name').value.trim();
    const desc = formWrapper.querySelector('.item-desc').value.trim();
    const imgUrl = formWrapper.querySelector('.item-img').value.trim();
    if(!name) return alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ!');
    const card = document.getElementById(cityId);
    const section = card.querySelectorAll('.section')[dayIndex];

    const h4Selector = type==='attraction'? '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üèõ' : '–ï–¥–∞ üçú';
    let ul = Array.from(section.querySelectorAll('ul')).find(ul=>ul.previousSibling && ul.previousSibling.textContent===h4Selector);
    if(!ul){ const h4=document.createElement('h4'); h4.textContent=h4Selector; h4.style.marginTop='6px'; section.appendChild(h4); ul=document.createElement('ul'); section.appendChild(ul);}

    const li = document.createElement('li'); 
    li.innerHTML = `<strong>${name}</strong>${desc?': '+desc:''}${imgUrl?`<br><img src="${imgUrl}" style="width:100px;height:70px;object-fit:cover;border-radius:8px;margin-top:4px;">`:''}`;
    ul.appendChild(li);

    // localStorage
    const storageKey = `trip_${cityId}_day${dayIndex}`;
    const existing = JSON.parse(localStorage.getItem(storageKey)||'{}');
    if(!existing[type]) existing[type]=[];
    existing[type].push({name,desc,imgUrl});
    localStorage.setItem(storageKey,JSON.stringify(existing));

    formWrapper.querySelectorAll('input').forEach(i=>i.value='');
  };
}

// ====== –ó–ê–ì–†–£–ó–ö–ê localStorage ======
function loadSavedItems(cityId, dayIndex){
  const storageKey = `trip_${cityId}_day${dayIndex}`;
  const data = JSON.parse(localStorage.getItem(storageKey)||'{}');
  if(!data) return;
  const card = document.getElementById(cityId);
  const section = card.querySelectorAll('.section')[dayIndex];
  ['attraction','food'].forEach(type=>{
    if(!data[type]||!data[type].length) return;
    const h4Selector = type==='attraction'? '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üèõ':'–ï–¥–∞ üçú';
    let ul = Array.from(section.querySelectorAll('ul')).find(ul=>ul.previousSibling && ul.previousSibling.textContent===h4Selector);
    if(!ul){ const h4=document.createElement('h4'); h4.textContent=h4Selector; h4.style.marginTop='6px'; section.appendChild(h4); ul=document.createElement('ul'); section.appendChild(ul);}
    data[type].forEach(item=>{
      const li=document.createElement('li');
      li.innerHTML = `<strong>${item.name}</strong>${item.desc?': '+item.desc:''}${item.imgUrl?`<br><img src="${item.imgUrl}" style="width:100px;height:70px;object-fit:cover;border-radius:8px;margin-top:4px;">`:''}`;
      ul.appendChild(li);
    });
  });
}

// ====== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–ê–†–¢–û–ß–ï–ö ======
const mainContainer=document.getElementById('main-container');
const dayIndices = {};
tripData.forEach(city=>{
  dayIndices[city.city.toLowerCase()] = 0;
  const card=document.createElement('div'); card.id=city.city.toLowerCase(); card.className='card';
  const h2=document.createElement('h2'); h2.textContent=city.city; card.appendChild(h2);

  city.days.forEach((day,dayIndex)=>{
    const section=document.createElement('div'); section.className='section';
    const h3=document.createElement('h3'); h3.textContent=`–î–µ–Ω—å ${day.day} ${day.title}`; section.appendChild(h3);

    if(day.attractions && day.attractions.length){ const h4a=document.createElement('h4'); h4a.textContent="–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üèõ"; section.appendChild(h4a); const ulA=document.createElement('ul'); day.attractions.forEach(a=>{const li=document.createElement('li'); li.textContent=a; ulA.appendChild(li);}); section.appendChild(ulA);}
    if(day.food && day.food.length){ const h4f=document.createElement('h4'); h4f.textContent="–ï–¥–∞ üçú"; section.appendChild(h4f); const ulF=document.createElement('ul'); day.food.forEach(f=>{const li=document.createElement('li'); li.textContent=f; ulF.appendChild(li);}); section.appendChild(ulF);}

    section.appendChild(createGallery(day.folder));

    // –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    addEditForm(section, city.city.toLowerCase(), dayIndex);
    loadSavedItems(city.city.toLowerCase(), dayIndex);

    card.appendChild(section);
  });

  const nav=document.createElement('div'); nav.className='day-nav';
  const prevBtn=document.createElement('button'); prevBtn.textContent='‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å';
  const nextBtn=document.createElement('button'); nextBtn.textContent='–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å ‚Üí';
  nav.appendChild(prevBtn); nav.appendChild(nextBtn); card.appendChild(nav);
  mainContainer.appendChild(card);

  const numDays=city.days.length;
  prevBtn.onclick = ()=>{ dayIndices[city.city.toLowerCase()]--; if(dayIndices[city.city.toLowerCase()]<0) dayIndices[city.city.toLowerCase()]=numDays-1; showDay(city.city.toLowerCase(),dayIndices[city.city.toLowerCase()]);};
  nextBtn.onclick = ()=>{ dayIndices[city.city.toLowerCase()]++; if(dayIndices[city.city.toLowerCase()]>=numDays) dayIndices[city.city.toLowerCase()]=0; showDay(city.city.toLowerCase(),dayIndices[city.city.toLowerCase()]);};
});

// ====== –ü–û–ö–ê–ó –î–ù–Ø ======
function showDay(cityId,dayIndex){ const card=document.getElementById(cityId); const sections=card.querySelectorAll('.section'); sections.forEach((sec,idx)=>sec.style.display=(idx===dayIndex)?'block':'none'); }
Object.keys(dayIndices).forEach(cityId=>showDay(cityId,0));

// ====== BURGER –ú–ï–ù–Æ ======
const burger=document.getElementById('burger'); const sidebar=document.getElementById('sidebar');
burger.onclick=()=>sidebar.classList.toggle('open');

// ====== –ú–ï–ù–Æ –ì–û–†–û–î–û–í ======
const attrButtons=document.getElementById('attr-buttons'); const foodButtons=document.getElementById('food-buttons');
tripData.forEach(city=>{
  const btnA=document.createElement('button'); btnA.textContent=city.city; btnA.onclick=()=>{openCity(city.city.toLowerCase()); sidebar.classList.remove('open');}; attrButtons.appendChild(btnA);
  const btnF=document.createElement('button'); btnF.textContent=city.city; btnF.onclick=()=>{openCity(city.city.toLowerCase()); sidebar.classList.remove('open');}; foodButtons.appendChild(btnF);
});

function openCity(cityId){ document.querySelectorAll('.card').forEach(c=>c.classList.remove('active')); document.getElementById(cityId).classList.add('active'); showDay(cityId,0);}

// ====== SERVICE WORKER ======
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}

}); // DOMContentLoaded
</script>
</body>
</html>
